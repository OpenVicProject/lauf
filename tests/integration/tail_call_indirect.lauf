module @tail_call_indirect;

function @do_sth(2 => 3) {
    pop 0;
    uint 10;
    uint 20;
    return;
}

function @call(1 => 3) {
    uint 2;
    function_addr @do_sth; tail_call_indirect (2 => 3);
}

function @main() {
    [
        uint 1;
        call @call;
        uint 20; $lauf.test.assert_eq;
        uint 10; $lauf.test.assert_eq;
        uint 1; $lauf.test.assert_eq;
    ]

    return;
}

